{% extends 'base.html.twig' %}

{% block body %}

    {% include 'admin/layout/navbar.html.twig' %}

    <div class="mt-5 ml-5">
        <h3 class="text-viaautomobile mb-5"><b>OPÉRATIONS DIVERSES</b></h3>
        <form id="myform" action="" method="POST">
            <div class="form-group">
                <label for="">Mettre les mandats à 0</label>
                <input type="text" class="form-control" name="mandat">
                <small id="" class="form-text text-muted">Cette action sera irréversible</small>
            </div>
            <div class="form-group">
                <label for="">Mettre les ventes à 0</label>
                <input type="text" class="form-control" name="vente">
                <small id="" class="form-text text-muted">Cette action sera irréversible</small>
            </div>
            <div class="form-group">
                <label for="">Ajouter un nouvel administrateur</label>
                <select name="name" class="form-control">
                    <option id="periode" selected="selected"><span>Collaborateurs</span></option>
                    {% for user in users %}
                        {% if 'ROLE_ADMIN' not in user.roles %}
                            <option>{{ user.prenom }} {{ user.nom }}</option>
                        {% endif %}
                    {% endfor %}
                </select>
            </div>
            <button id="js-add" type="submit" class="btn btn-light light-button mb-2">Enregistrer</button>
        </form>
    </div>

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.1/jquery.min.js"></script>
    <script type="text/javascript">

        $(document).ready(function() {

            $('#js-add').click(function (e){
                e.preventDefault();

                var mandat = $('input[name="mandat"]').val();
                var vente = $('input[name="vente"]').val();
                var collaborateur = $('select[name="name"]').val();

                jQuery.ajax({
                    url: '{{ path('admin-miscellaneous-add') }}',
                    type: 'POST',
                    data: {
                        mandat: mandat,
                        vente: vente,
                        name: collaborateur
                    },
                    success: function (data) {
                        toastr.success("Données à jour")
                    },
                    error: function (jqxhr) {
                        alert(jqxhr.responseText);
                    }
                });

            });


        });
    </script>

{% endblock %}